# Convex Backend Directory

## Overview
This directory contains all Convex backend configuration, database schema, queries, mutations, and sync functions for CFP Machine.

## Files

### `schema.ts`
Database schema definitions for:
- **teams**: FBS college football teams
- **conferences**: College football conferences
- **games**: Game schedules and results
- **teamRecords**: Season records for teams
- **syncStatus**: Tracking API sync status

### `teams.ts`
Team-related database operations:
- `list`: Query all teams or filter by conference
- `getBySchoolId`: Get single team by ID
- `upsertTeam`: Create or update team data

### `conferences.ts`
Conference-related database operations:
- `list`: Query all conferences
- `getByConferenceId`: Get single conference
- `getConferenceWithTeams`: Get conference with all its teams
- `upsertConference`: Create or update conference

### `games.ts`
Game-related database operations:
- `listByWeek`: Get games for specific week
- `listByTeam`: Get all games for a team
- `upsertGame`: Create or update game data

### `sync.ts`
Background sync functions for College Football Data API:
- `syncFBSTeams`: Fetch and store all FBS teams
- `syncConferences`: Fetch and store conferences
- `syncGamesForWeek`: Fetch games for specific week
- `syncCurrentSeason`: Full season sync orchestrator
- `updateSyncStatus`: Track sync operations

## Database Indexes
- Teams indexed by school ID and conference
- Conferences indexed by conference ID
- Games indexed by game ID, season/week, and team IDs
- Team records indexed by team/season
- Sync status indexed by sync type

## Usage
1. Run `npx convex dev` to start Convex backend
2. Functions are automatically deployed
3. Use `syncCurrentSeason` action to populate data
4. Query functions available to frontend via Convex client

## Environment Variables Required
```
CFB_API_KEY=your-collegefootballdata-api-key
```